<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<!-- ****************************************************** -->
<!--            Standard wxWidgets header                   -->

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <title>wxWidgets: Drag and Drop Overview</title>
    <meta name="author" content="wxWidgets team"/>
    <meta name="created" content="Fri Sep 4 06:57:19 2009"/>
    <meta name="keywords" content="wxWidgets"/>
    <link href="wxwidgets.css" rel="stylesheet" type="text/css"/>
    <link href="tabs.css" rel="stylesheet" type="text/css"/>
</head>
<body>


<!--          End of wxWidgets standard header           -->
<!-- *************************************************** -->

<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Categories</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="index.html">Reference manual</a>&nbsp;&raquo&nbsp;<a class="el" href="page_topics.html">Topic Overviews</a>
  </div>
</div>
<div class="contents">
<h1><a class="anchor" name="overview_dnd">Drag and Drop Overview </a></h1>Classes: <a class="el" href="classwx_data_object.html" title="A wxDataObject represents data that can be copied to or from the clipboard, or dragged...">wxDataObject</a>, <a class="el" href="classwx_text_data_object.html" title="wxTextDataObject is a specialization of wxDataObjectSimple for text data.">wxTextDataObject</a>, <a class="el" href="classwx_drop_source.html" title="This class represents a source for a drag and drop operation.">wxDropSource</a>, <a class="el" href="classwx_drop_target.html" title="This class represents a target for a drag and drop operation.">wxDropTarget</a>, <a class="el" href="classwx_text_drop_target.html" title="A predefined drop target for dealing with text data.">wxTextDropTarget</a>, <a class="el" href="classwx_file_drop_target.html" title="This is a drop target which accepts files (dragged from File Manager or Explorer)...">wxFileDropTarget</a><p>
Note that <code>wxUSE_DRAG_AND_DROP</code> must be defined in <code>setup.h</code> in order to use drag and drop in wxWidgets.<p>
See also: <a class="el" href="overview_dataobject.html">wxDataObject Overview</a> and <a class="el" href="page_samples.html#page_samples_dnd">Drag &amp; Drop Sample</a>.<p>
It may be noted that data transfer to and from the clipboard is quite similar to data transfer with drag and drop and the code to implement these two types is almost the same. In particular, both data transfer mechanisms store data in some kind of <a class="el" href="classwx_data_object.html" title="A wxDataObject represents data that can be copied to or from the clipboard, or dragged...">wxDataObject</a> and identify its format(s) using the <a class="el" href="classwx_data_format.html" title="A wxDataFormat is an encapsulation of a platform-specific format handle which is...">wxDataFormat</a> class.<p>
To be a <em>drag</em> source, i.e. to provide the data which may be dragged by the user elsewhere, you should implement the following steps:<p>
<ul>
<li><b>Preparation:</b> First of all, a data object must be created and initialized with the data you wish to drag. For example:</li>
</ul>
<div class="fragment"><pre class="fragment">    <a class="code" href="classwx_text_data_object.html" title="wxTextDataObject is a specialization of wxDataObjectSimple for text data.">wxTextDataObject</a> my_data(<span class="stringliteral">"This text will be dragged."</span>);
</pre></div><p>
<ul>
<li><b>Drag start</b>: To start the dragging process (typically in response to a mouse click) you must call <a class="el" href="classwx_drop_source.html#7053f3286614a78d0fd8c282c286778d" title="Starts the drag-and-drop operation which will terminate when the user releases the...">wxDropSource::DoDragDrop</a> like this:</li>
</ul>
<div class="fragment"><pre class="fragment">    <a class="code" href="classwx_drop_source.html" title="This class represents a source for a drag and drop operation.">wxDropSource</a> dragSource( <span class="keyword">this</span> );
    dragSource.SetData( my_data );
    <a class="code" href="interface_2wx_2dnd_8h.html#dbd4b292582eebbc9a6ce3dee31c2afb" title="Result returned from a wxDropSource::DoDragDrop() call.">wxDragResult</a> result = dragSource.DoDragDrop( <span class="keyword">true</span> );
</pre></div><p>
<ul>
<li><b>Dragging:</b> The call to DoDragDrop() blocks the program until the user releases the mouse button (unless you override the <a class="el" href="classwx_drop_source.html#2b667de6f631839d4c4383f436726f7f" title="You may give some custom UI feedback during the drag and drop operation by overriding...">wxDropSource::GiveFeedback</a> function to do something special). When the mouse moves in a window of a program which understands the same drag-and-drop protocol (any program under Windows or any program supporting the XDnD protocol under X Windows), the corresponding <a class="el" href="classwx_drop_target.html" title="This class represents a target for a drag and drop operation.">wxDropTarget</a> methods are called - see below.</li>
</ul>
<ul>
<li><b>Processing the result</b>: DoDragDrop() returns an <em>effect</em> code which is one of the values of <code>wxDragResult</code> enum (explained in <a class="el" href="classwx_drop_target.html" title="This class represents a target for a drag and drop operation.">wxDropTarget</a> page):</li>
</ul>
<div class="fragment"><pre class="fragment">    <span class="keywordflow">switch</span> (result)
    {
        <span class="keywordflow">case</span> <a class="code" href="interface_2wx_2dnd_8h.html#dbd4b292582eebbc9a6ce3dee31c2afb736c04c59caf8154a096e0d350492fc1" title="The data was successfully copied.">wxDragCopy</a>:
            <span class="comment">// copy the data</span>
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="interface_2wx_2dnd_8h.html#dbd4b292582eebbc9a6ce3dee31c2afb8b2ba916ca49cc93ef34a5e20684d18e" title="The data was successfully moved (MSW only).">wxDragMove</a>:
            <span class="comment">// move the data</span>
            <span class="keywordflow">break</span>;
        <span class="keywordflow">default</span>:
            <span class="comment">// do nothing</span>
            <span class="keywordflow">break</span>;
    }
</pre></div><p>
To be a <em>drop</em> target, i.e. to receive the data dropped by the user you should follow the instructions below:<p>
<ul>
<li><b>Initialization:</b> For a window to be a drop target, it needs to have an associated <a class="el" href="classwx_drop_target.html" title="This class represents a target for a drag and drop operation.">wxDropTarget</a> object. Normally, you will call <a class="el" href="classwx_window.html#e34b4d45433ca8287df0e47d46411e58" title="Associates a drop target with this window.">wxWindow::SetDropTarget</a> during window creation associating your drop target with it. You must derive a class from <a class="el" href="classwx_drop_target.html" title="This class represents a target for a drag and drop operation.">wxDropTarget</a> and override its pure virtual methods. Alternatively, you may derive from <a class="el" href="classwx_text_drop_target.html" title="A predefined drop target for dealing with text data.">wxTextDropTarget</a> or <a class="el" href="classwx_file_drop_target.html" title="This is a drop target which accepts files (dragged from File Manager or Explorer)...">wxFileDropTarget</a> and override their OnDropText() or OnDropFiles() method.</li>
</ul>
<ul>
<li><b>Drop:</b> When the user releases the mouse over a window, wxWidgets asks the associated <a class="el" href="classwx_drop_target.html" title="This class represents a target for a drag and drop operation.">wxDropTarget</a> object if it accepts the data. For this, a <a class="el" href="classwx_data_object.html" title="A wxDataObject represents data that can be copied to or from the clipboard, or dragged...">wxDataObject</a> must be associated with the drop target and this data object will be responsible for the format negotiation between the drag source and the drop target. If all goes well, then <a class="el" href="classwx_drop_target.html#5c27f66d59eb89ab7e014fd153ace093" title="Called after OnDrop() returns true.">wxDropTarget::OnData</a> will get called and the <a class="el" href="classwx_data_object.html" title="A wxDataObject represents data that can be copied to or from the clipboard, or dragged...">wxDataObject</a> belonging to the drop target can get filled with data.</li>
</ul>
<ul>
<li><b>The end</b>: After processing the data, DoDragDrop() returns either wxDragCopy or wxDragMove depending on the state of the keys Ctrl, Shift and Alt at the moment of the drop. There is currently no way for the drop target to change this return code. </li>
</ul>
</div>
<!-- ******************************************************* -->
<!--             Standard wxWidgets footer                   -->

<!-- NOTE: <br/> must go inside <p> but <hr/> must go outside -->
<p><br/></p><hr/>

<table width="100%" border="0">
<tr>
    <td align="left">
        <a href="http://www.wxwidgets.org" style="margin-left: 0px">
            <img src="powered-by-wxwidgets.png" alt="wxWidgets logo" border="0"/>
        </a>
    </td>
    <td valign="middle" align="center"><p class="footer">Page generated <tt>Fri Sep 4 06:57:19 2009</tt> by <a href="http://www.doxygen.org">Doxygen</a> 1.5.8</p></td>
    <td valign="middle" align="right"><p>[ <a href="#top" class="top">top</a> ]</p></td>
</tr>
</table>

<script src="wxwidgets.js" type="text/javascript"></script>

</body>
</html>

<!-- ***************************************************** -->
<!--         End of wxWidgets standard footer              -->
