<html>

<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>IP Address Controls</title>
</head>

<body>

<h2>IP Address Controls</h2>
<hr SIZE="1">
<p>An Internet Protocol (IP) address control allows the user to enter an IP
address in an easily understood format. This control also allows the application
to obtain the address in numeric form rather than in text form.</p>
<ul>
  <li><a href="#_win32_ipadd_about" target="_self">About IP Address Controls</a>
  <li><a href="#Using_IP_Address_Con" target="_self">Using IP Address Controls</a></li>
</ul>
<h3><a name="_win32_ipadd_about"></a>About IP Address Controls</h3>
<p>Microsoft® Internet Explorer Version 4.0 introduces the IP address control,
a new control similar to an edit control that allows the user to enter a numeric
address in Internet protocol (IP) format. This format consists of four
three-digit fields. Each field is treated individually; the field numbers are
zero-based and proceed from left to right as shown in this figure.</p>
<p><img border="0" src="ip_add29.gif" width="174" height="133"></p>
<p>The control allows only numeric text to be entered in each of the fields.
Once three digits have been entered in a given field, keyboard focus is
automatically moved to the next field. If filling the entire field is not
required by the application, the user can enter fewer than three digits. For
example, if the field should only contain 21, typing 21 and pressing the key
will take the user to the next field.</p>
<p>The default range for each field is 0 to 255, but the application can set the
range to any values between those limits with the <MSHelp:link tabIndex=0 
xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_IPM_SETRANGE_cpp">
IPM_SETRANGE</MSHelp:link>
 message.</p>
<div class="clsNote">
  <b>Note</b>&nbsp;&nbsp;The IP address control is implemented in version 4.71
  and later of Comctl32.dll.
</div>
<h3><a name="Initializing_an_IP_A"></a>Initializing an IP Address Control</h3>
<p>To use an IP address control, call <MSHelp:link tabIndex=0 
xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_InitCommonControlsEx_cpp">
InitCommonControlsEx</MSHelp:link>
 with the <span class="clsLiteral">ICC_INTERNET_CLASSES</span> flag set in the <b>dwICC</b>
member of the <MSHelp:link tabIndex=0 
xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_INITCOMMONCONTROLSEX_4vvx_cpp">
INITCOMMONCONTROLSEX</MSHelp:link>
 structure.</p>
<h3><a name="Creating_an_IP_Addre"></a>Creating an IP Address Control</h3>
<p>Use the <MSHelp:link tabIndex=0 
xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_CreateWindow">
CreateWindow</MSHelp:link>
 or the <MSHelp:link 
tabIndex=0 xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_CreateWindowEx">
CreateWindowEx</MSHelp:link>
application programming interface (API) to create an IP address control. The
class name for the control is WC_IPADDRESS, which is defined in Commctrl.h. No
IP address control-specific styles exist; however, because this is a child
control, use the WS_CHILD style as a minimum.</p>
<h3><a name="Is_an_IP_Address_Con"></a>Is an IP Address Control an Edit Control?</h3>
<p>An IP address control is not an edit control and it will not respond to EM_
messages. It will, however, send the owner window the following edit control
notifications through the <MSHelp:link tabIndex=0 
xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_wm_command">
WM_COMMAND</MSHelp:link>
 message. Note that the IP address control will also send private IPN_
notifications through the <MSHelp:link tabIndex=0 xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_WM_NOTIFY_cpp">
WM_NOTIFY</MSHelp:link>
 message.</p>
<table class="clsStd">
  <tbody>
    <tr>
      <td><b>Notification</b></td>
      <td><b>Reason for notification</b></td>
    </tr>
    <tr>
      <td><MSHelp:link tabIndex=0 xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_EN_SETFOCUS_cpp">
        EN_SETFOCUS</MSHelp:link>
      </td>
      <td>Sent when the IP address control gains the keyboard focus.</td>
    </tr>
    <tr>
      <td><MSHelp:link tabIndex=0 xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_EN_KILLFOCUS_cpp">
        EN_KILLFOCUS</MSHelp:link>
      </td>
      <td>Sent when the IP address control loses the keyboard focus.</td>
    </tr>
    <tr>
      <td><MSHelp:link tabIndex=0 xmlns:MSHelp="http://msdn.microsoft.com/mshelp" 
keywords="_win32_EN_CHANGE_cpp">
        EN_CHANGE</MSHelp:link>
      </td>
      <td>Sent when any field in the IP address control changes. Like the <b>EN_CHANGE</b>
        notification from a standard edit control, this notification is received
        after the screen has been updated.</td>
    </tr>
  </tbody>
</table>

</body>

</html>
