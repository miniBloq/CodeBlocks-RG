<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./DirectXWithlcc_files/filelist.xml">
<title>Programming DirectX with lcc-win32</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>jacob navia</o:Author>
  <o:LastAuthor>jacob navia</o:LastAuthor>
  <o:Revision>7</o:Revision>
  <o:TotalTime>310</o:TotalTime>
  <o:Created>2001-05-24T19:07:00Z</o:Created>
  <o:LastSaved>2003-03-09T01:05:00Z</o:LastSaved>
  <o:Pages>15</o:Pages>
  <o:Words>7314</o:Words>
  <o:Characters>41695</o:Characters>
  <o:Company>logiciels/informatique</o:Company>
  <o:Lines>347</o:Lines>
  <o:Paragraphs>83</o:Paragraphs>
  <o:CharactersWithSpaces>51204</o:CharactersWithSpaces>
  <o:Version>9.4402</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:DrawingGridHorizontalSpacing>3.9 pt</w:DrawingGridHorizontalSpacing>
  <w:DrawingGridVerticalSpacing>5.3 pt</w:DrawingGridVerticalSpacing>
  <w:DisplayHorizontalDrawingGridEvery>0</w:DisplayHorizontalDrawingGridEvery>
  <w:DisplayVerticalDrawingGridEvery>2</w:DisplayVerticalDrawingGridEvery>
 </w:WordDocument>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:"Arial Narrow";
	panose-1:2 11 5 6 2 2 2 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"Lucida Sans Typewriter";
	panose-1:2 11 5 9 3 5 4 3 2 4;
	mso-font-alt:"Courier New";
	mso-font-charset:0;
	mso-generic-font-family:modern;
	mso-font-pitch:fixed;
	mso-font-signature:3 0 0 0 1 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:11.0pt;
	margin-right:6.0pt;
	margin-bottom:11.0pt;
	margin-left:6.0pt;
	line-height:22.0pt;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	tab-stops:18.0pt 30.0pt 42.0pt;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial Narrow";
	mso-font-kerning:0pt;
	mso-bidi-font-weight:normal;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:"Times New Roman";
	mso-bidi-font-family:Arial;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:13.0pt;
	font-family:"Times New Roman";
	mso-bidi-font-family:Arial;}
h4
	{mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:7.0pt;
	margin-right:6.0pt;
	margin-bottom:7.0pt;
	margin-left:6.0pt;
	line-height:14.0pt;
	mso-pagination:widow-orphan;
	mso-outline-level:4;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial Narrow";
	mso-bidi-font-weight:normal;}
h5
	{mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-weight:normal;
	text-decoration:underline;
	text-underline:single;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:11.9pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:right dotted 415.15pt;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:24.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:48.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:60.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:72.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc8, li.MsoToc8, div.MsoToc8
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:84.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoToc9, li.MsoToc9, div.MsoToc9
	{mso-style-update:auto;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:96.0pt;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:justify;
	mso-pagination:widow-orphan;
	tab-stops:center 216.0pt right 432.0pt;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
span.MsoFootnoteReference
	{vertical-align:super;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	font-size:18.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p.Lb1, li.Lb1, div.Lb1
	{mso-style-name:Lb1;
	mso-style-parent:"";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:18.0pt;
	text-indent:-12.0pt;
	line-height:12.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Np1, li.Np1, div.Np1
	{mso-style-name:Np1;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:9.0pt;
	margin-bottom:0cm;
	margin-left:9.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.Nh, li.Nh, div.Nh
	{mso-style-name:Nh;
	mso-style-parent:"";
	mso-style-next:Np1;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial Narrow";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Ns, li.Ns, div.Ns
	{mso-style-name:Ns;
	mso-style-parent:"";
	mso-style-next:Nh;
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:6.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Ex, li.Ex, div.Ex
	{mso-style-name:Ex;
	mso-style-parent:"";
	margin-top:0cm;
	margin-right:6.0pt;
	margin-bottom:0cm;
	margin-left:6.0pt;
	margin-bottom:.0001pt;
	line-height:12.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:8.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Lucida Sans Typewriter";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Ne, li.Ne, div.Ne
	{mso-style-name:Ne;
	mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:8.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.LangBegin, li.LangBegin, div.LangBegin
	{mso-style-name:LangBegin;
	mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	border:none;
	mso-border-top-alt:solid windowtext .75pt;
	padding:0cm;
	mso-padding-alt:3.0pt 0cm 0cm 0cm;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:blue;}
p.LangEnd, li.LangEnd, div.LangEnd
	{mso-style-name:LangEnd;
	mso-style-parent:Ne;
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:12.0pt;
	margin-left:0cm;
	line-height:8.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	border:none;
	mso-border-top-alt:solid windowtext .75pt;
	padding:0cm;
	mso-padding-alt:1.0pt 0cm 0cm 0cm;
	font-size:6.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:blue;}
p.Rmh, li.Rmh, div.Rmh
	{mso-style-name:Rmh;
	mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:7.0pt;
	margin-right:0cm;
	margin-bottom:7.0pt;
	margin-left:0cm;
	line-height:14.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial Narrow";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Leh, li.Leh, div.Leh
	{mso-style-name:Leh;
	mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-line-height-alt:4.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.Art, li.Art, div.Art
	{mso-style-name:Art;
	mso-style-parent:"";
	mso-style-next:Normal;
	margin-top:0cm;
	margin-right:6.0pt;
	margin-bottom:6.0pt;
	margin-left:6.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Tp, li.Tp, div.Tp
	{mso-style-name:Tp;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.Tr, li.Tr, div.Tr
	{mso-style-name:Tr;
	mso-style-parent:"";
	mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:4.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Tpf, li.Tpf, div.Tpf
	{mso-style-name:Tpf;
	mso-style-parent:Tp;
	mso-style-next:Tp;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.Tes, li.Tes, div.Tes
	{mso-style-name:Tes;
	mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:8.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:6.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.Rh1, li.Rh1, div.Rh1
	{mso-style-name:Rh1;
	mso-style-parent:"";
	mso-style-next:Normal;
	margin:6.0pt;
	line-height:22.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:20.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Arial Narrow";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Def1, li.Def1, div.Def1
	{mso-style-name:Def1;
	mso-style-next:Term1;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:18.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.Term1, li.Term1, div.Term1
	{mso-style-name:Term1;
	mso-style-next:Def1;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
p.ExSyn, li.ExSyn, div.ExSyn
	{mso-style-name:ExSyn;
	margin:0cm;
	margin-bottom:.0001pt;
	line-height:12.0pt;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:9.5pt;
	mso-bidi-font-size:10.0pt;
	font-family:"Lucida Sans Typewriter";
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
p.Th, li.Th, div.Th
	{mso-style-name:Th;
	mso-style-parent:Tp;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
p.Thf, li.Thf, div.Thf
	{mso-style-name:Thf;
	mso-style-parent:Th;
	mso-style-next:Th;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:3.0pt;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-layout-grid-align:none;
	punctuation-wrap:simple;
	text-autospace:none;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;
	mso-bidi-font-weight:normal;}
@page Section1
	{size:21.0cm 842.0pt;
	margin:72.0pt 89.85pt 72.0pt 89.85pt;
	mso-header-margin:36.0pt;
	mso-footer-margin:36.0pt;
	mso-even-footer:url("./DirectXWithlcc_files/header.htm") ef1;
	mso-footer:url("./DirectXWithlcc_files/header.htm") f1;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:54670468;
	mso-list-type:hybrid;
	mso-list-template-ids:-2133698864 -1268365100 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:54.0pt;
	mso-level-number-position:left;
	margin-left:54.0pt;
	text-indent:-36.0pt;
	font-family:Symbol;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";}
@list l1
	{mso-list-id:159925527;
	mso-list-type:hybrid;
	mso-list-template-ids:1744073296 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l2
	{mso-list-id:377512089;
	mso-list-type:hybrid;
	mso-list-template-ids:952387982 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l3
	{mso-list-id:485360993;
	mso-list-type:hybrid;
	mso-list-template-ids:-126161480 -1666147160 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:54.0pt;
	mso-level-number-position:left;
	margin-left:54.0pt;
	text-indent:-36.0pt;
	font-family:Symbol;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Arial;}
@list l4
	{mso-list-id:779761478;
	mso-list-type:hybrid;
	mso-list-template-ids:1287705294 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l5
	{mso-list-id:1012531844;
	mso-list-type:hybrid;
	mso-list-template-ids:1304591200 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l6
	{mso-list-id:1164591069;
	mso-list-type:hybrid;
	mso-list-template-ids:-1667617328 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l7
	{mso-list-id:1574662485;
	mso-list-type:hybrid;
	mso-list-template-ids:1407897886 -1666147160 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l7:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:54.0pt;
	mso-level-number-position:left;
	margin-left:54.0pt;
	text-indent:-36.0pt;
	font-family:Symbol;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Arial;}
@list l8
	{mso-list-id:1785035429;
	mso-list-type:hybrid;
	mso-list-template-ids:-1591210410 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l9
	{mso-list-id:1936862936;
	mso-list-type:hybrid;
	mso-list-template-ids:-1122835680 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l10
	{mso-list-id:2145846717;
	mso-list-type:hybrid;
	mso-list-template-ids:-958081410 -1666147160 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l10:level1
	{mso-level-start-at:0;
	mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:54.0pt;
	mso-level-number-position:left;
	margin-left:54.0pt;
	text-indent:-36.0pt;
	font-family:Symbol;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Arial;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:36.0pt'>

<div class=Section1>

<h2><span style='font-family:Arial'>Programming for DirectX 8 with lcc-win32<o:p></o:p></span></h2>

<p class=MsoToc2><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoToc2><!--[if supportFields]><span style='mso-element:field-begin'></span><span
style="mso-spacerun: yes"> </span>TOC \o &quot;1-3&quot; \h \z <span
style='mso-element:field-separator'></span><![endif]--><span
class=MsoHyperlink><a href="#_Toc515374545">Using COM<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>.. </span><span style='mso-field-code:"PAGEREF _Toc515374545 \\h"'>1<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500340035000000</w:data>
</xml><![endif]--></span></span></a></span><span style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374546">DirectX COM Documentation
conventions<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374546 \\h"'>2<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500340036000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374547">What is a COM object?<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374547 \\h"'>2<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500340037000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374548">Objects and Interfaces<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374548 \\h"'>2<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500340038000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374549">GUIDs<span style='color:windowtext;
display:none;mso-hide:screen;text-decoration:none;text-underline:none'><span
style='mso-tab-count:1 dotted'>. </span><span style='mso-field-code:"PAGEREF _Toc515374549 \\h"'>3<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500340039000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374550">HRESULT Values<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374550 \\h"'>4<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350030000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374551">The Address of a Pointer<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'> </span><span
style='mso-field-code:"PAGEREF _Toc515374551 \\h"'>5<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350031000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc515374552">Creating a
COM object<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'> </span><span
style='mso-field-code:"PAGEREF _Toc515374552 \\h"'>5<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350032000000</w:data>
</xml><![endif]--></span></span></a></span><span style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc2><span class=MsoHyperlink><a href="#_Toc515374553">Using COM
Interfaces<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374553 \\h"'>7<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350033000000</w:data>
</xml><![endif]--></span></span></a></span><span style='font-size:12.0pt'><o:p></o:p></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374554">Requesting Additional Interfaces<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374554 \\h"'>7<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350034000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374555">Managing a COM Object's Lifetime<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374555 \\h"'>8<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350035000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374556">Incrementing and Decrementing the
Reference Count<span style='color:windowtext;display:none;mso-hide:screen;
text-decoration:none;text-underline:none'><span style='mso-tab-count:1 dotted'> </span><span
style='mso-field-code:"PAGEREF _Toc515374556 \\h"'>8<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350036000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374557">Using macros to call DirectX
methods.<span style='color:windowtext;display:none;mso-hide:screen;text-decoration:
none;text-underline:none'><span style='mso-tab-count:1 dotted'> </span><span
style='mso-field-code:"PAGEREF _Toc515374557 \\h"'>9<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350037000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374558">The IUnknown interface<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374558 \\h"'>9<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350038000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374559">Using Callback functions<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374559 \\h"'>10<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500350039000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374560">Implementing a Callback Function<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374560 \\h"'>10<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500360030000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374561">Version Checking<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374561 \\h"'>11<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500360031000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374562">Checking the operating System version.<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'> </span><span
style='mso-field-code:"PAGEREF _Toc515374562 \\h"'>15<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500360032000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoToc3 style='tab-stops:right dotted 415.15pt'><span
class=MsoHyperlink><a href="#_Toc515374563">Preparing for Compilation<span
style='color:windowtext;display:none;mso-hide:screen;text-decoration:none;
text-underline:none'><span style='mso-tab-count:1 dotted'>. </span><span
style='mso-field-code:"PAGEREF _Toc515374563 \\h"'>16<!--[if gte mso 9]><xml>
 <w:data>08D0C9EA79F9BACE118C8200AA004BA90B02000000080000000E0000005F0054006F0063003500310035003300370034003500360033000000</w:data>
</xml><![endif]--></span></span></a></span></p>

<p class=MsoNormal><!--[if supportFields]><span style='font-size:14.0pt;
mso-bidi-font-size:12.0pt'><span style='mso-element:field-end'></span></span><![endif]--><span
style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Most DirectX
application development with lcc-win32 involves conventional programming
techniques. However, there are several aspects of DirectX programming that may
be unfamiliar to users. This section provides a brief overview of several
specialized topics, along with some guidelines for compiling and debugging
DirectX applications.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l7 level1 lfo2;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Using COM</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l7 level1 lfo2;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Using Callback
Functions</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l7 level1 lfo2;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Version
Checking</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l7 level1 lfo2;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Compiling
DirectX Samples and Other DirectX Applications</span><span style='font-family:
Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l0 level1 lfo4;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]>Debugging DirectX Applications<span style='font-family:
Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h2><a name="_Toc515331867"></a><a name="_Toc515374545"><span style='mso-bookmark:
_Toc515331867'>Using COM</span></a></h2>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>The Component
Object Model (COM) is an object-oriented programming model used by numerous
applications. Because the bulk of the DirectX run time is in the form of
COM-compliant objects, all DirectX developers need to have at least a basic
understanding of COM principles and programming techniques. However, although
COM has a reputation for being difficult and complex, the COM programming
required by most DirectX applications is straightforward.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>There are two
distinct types of COM programming:</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal>Using existing COM objects. This is not much more difficult
than using C++ objects. <span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l10 level1 lfo6;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Implementing
your own COM objects. This can be a complicated and demanding task. Much of
COM's reputation for complexity comes from this type of COM programming.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Most DirectX
applications need to use only the COM objects provided by DirectX. They do not
need to implement their own COM objects. In other words, most DirectX
developers will need to concern themselves only with the first, and easiest,
type of COM programming.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>This section
provides a brief introduction to using the COM objects provided by DirectX. It
is primarily intended for novice COM programmers. For a more detailed
discussion of how to use COM objects, or for information on how to implement
your own COM objects, see Further Information.</span><span style='font-family:
Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>What is a COM
Object?</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Creating a COM
Object</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Using COM
Interfaces</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Managing a COM
Object's Lifetime</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Using C to
Access COM Objects</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>Using Macros
to Call DirectX COM Methods</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 54.0pt'><![if !supportLists]><span lang=FR style='font-family:
Symbol;mso-bidi-font-family:Arial;mso-ansi-language:FR'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span lang=FR style='mso-bidi-font-family:Arial;
mso-ansi-language:FR'>DirectX COM Documentation Conventions</span><span
lang=FR style='font-family:Arial;mso-ansi-language:FR'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:54.0pt;text-indent:-36.0pt;mso-list:l3 level1 lfo8;
tab-stops:list 54.0pt'><![if !supportLists]><span style='font-family:Symbol;
mso-bidi-font-family:Arial'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='mso-bidi-font-family:Arial'>IUnknown
Interface</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:18.0pt'><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331868"></a><a name="_Toc515374546"><span style='mso-bookmark:
_Toc515331868'>DirectX COM Documentation conventions</span></a></h3>

<p class=MsoNormal>By convention, COM methods and interfaces are referred to in
the documentation by their equivalent C++ class names. The Initialize method of
the IDirectPlay8Peer interface is thus referred to as
IDirectPlay8Peer::Initialize. The primary reason for this convention is that
different interfaces may export a method with the same name but with entirely
different functionality and syntax. For example, many interfaces have an Init
or Initialize method, but the functionality and parameters may be quite
different. Using the C++ class name is a convenient way to uniquely identify
the method. Note that this is used here for easy of use only, you shouldn’t try
to use this C++ syntax in code for lcc-win32.<span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331869"></a><a name="_Toc515374547"><span style='mso-bookmark:
_Toc515331869'>What is a COM object?</span></a></h3>

<p class=MsoNormal>COM objects are basically black boxes that can be used by
applications to perform one or more tasks. They are most commonly implemented
as DLLs. Like a conventional DLL, COM objects expose methods that your
application can call to perform any of the supported tasks. <span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal>COM objects contain procedures (methods), and some of them
contain data (properties). They expose an interface, i.e. a set of data and
procedures, that can be called or set/unset by the calling application.<span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>A COM object's public methods are grouped into one or more
interfaces. To use a method, you must create the object and obtain the
appropriate interface from the object. An interface typically contains a
related set of methods that provide access to a particular feature of the
object. For example, the IDirect3DCubeTexture8 interface contains methods that
enable you to manipulate cube texture resources. Any methods that are not part
of an interface are not accessible.<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>COM objects are not created in the same way as C structures.
There are several ways to create a COM object, but all involve COM-specific
techniques. The DirectX API includes a variety of helper functions and methods
that simplify creating most of the DirectX objects.<span style='font-family:
Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>You must use COM-specific techniques to control the lifetime
of the object. You should call the <span style='font-family:"Courier New"'>AddRef</span>
method, at the beginning, and always call <span style='font-family:"Courier New"'>Release</span>
when you are done using an object.<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>COM objects do not need to be explicitly loaded. COM objects
are typically contained in a DLL. However, you do not need to explicitly load
the DLL or link to a static library in order to use a COM object. Each COM
object has a unique registered identifier that is used to create the object.
The COM runtime automatically loads the correct DLL.<span style='font-family:
Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>Here is, to put a concrete example, a code snippet that will
call the COM Internet Explorer object:<span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>CLSID clsExcelApp;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>…<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>CLSIDFromProgID(<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span lang=FR style='font-family:
"Courier New";mso-ansi-language:FR'>L&quot;InternetExplorer.Application&quot;,
&amp;clsExplorerApp);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=FR style='font-family:Arial;mso-bidi-font-family:
"Times New Roman";mso-ansi-language:FR'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>The COM API <span style='font-family:"Courier New"'>CLSIDFromProgID</span>
will look in the registry and call the correct DLL for you.<span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>COM is a binary specification. COM objects can be written in
and accessed from a variety of languages. You don't need to know anything about
the object's source code. For example, lcc-win32 applications routinely use COM
objects that were written in C++.<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331870"></a><a name="_Toc515374548"><span style='mso-bookmark:
_Toc515331870'>Objects and Interfaces</span></a></h3>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>It is important to
understand the distinction between objects and interfaces. In casual usage, an
object may sometimes be referred to by the name of its principle interface.
However, strictly speaking, the two terms are not interchangeable.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'><span
style="mso-spacerun: yes"> </span>An object may expose any number of
interfaces. For example, while all objects must expose the </span><span
style='font-family:"Courier New"'>IUnknown</span><span style='mso-bidi-font-family:
Arial'> interface, they normally expose at least one additional interface, and
they might expose many. In order to use a particular method, you must not only
create the object, you must also obtain the correct interface.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>More than one
object might expose the same interface. An interface is a group of methods that
perform a specified set of operations. The interface definition specifies only
the syntax of the methods and their general functionality. Any COM object that
needs to support a particular set of operations can do so by exposing a
suitable interface. Some interfaces are highly specialized and are exposed only
by a single object. Others are useful in a variety of circumstances and are
exposed by many objects. The extreme case is the </span><span style='font-family:
"Courier New"'>IUnknown</span><span style='mso-bidi-font-family:Arial'>
interface, which must be exposed by all COM objects.<a style='mso-footnote-id:
ftn1' href="#_ftn1" name="_ftnref1" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]>[1]<![endif]></span></span></a></span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>The COM standard
requires that an interface definition must not change once it has been
published. You cannot, for example, add a new method to an existing, published
interface. You must instead create a new interface. While there are no
restrictions on what methods must be in an interface, a common practice is to
have the next-generation interface include all the of the old interface's
methods, plus any new methods.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>It is not unusual
for an interface to have several generations. Typically, all generations
perform essentially the same overall task, but they will be different in
detail. Often, an object will expose every generation of interface. Doing so
allows older applications to continue using the object's older interfaces,
while newer applications can take advantage of the features of the newer
interfaces. </span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Typically, a family
of interfaces will all have the same name, plus an integer indicating the
generation. For example, if the original interface were named </span><span
style='font-family:"Courier New"'>IMyInterface</span><span style='mso-bidi-font-family:
Arial'>, the next two generations would be called </span><span
style='font-family:"Courier New"'>IMyInterface2</span><span style='mso-bidi-font-family:
Arial'> and </span><span style='font-family:"Courier New"'>IMyInterface3</span><span
style='mso-bidi-font-family:Arial'>. DirectX typically labels successive
generations of interfaces with the DirectX version number.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331871"></a><a name="_Toc515374549"><span style='mso-bookmark:
_Toc515331871'>GUIDs</span></a></h3>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Globally Unique
Identifiers (GUIDs) are a key part of the COM programming model. At its most
basic, a GUID is a 128-bit structure. However, GUIDs are created in such as way
as to guarantee that no two GUIDs are the same. COM uses GUIDS extensively for
two primary purposes:</span><span style='font-family:Arial'><o:p></o:p></span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal style='mso-list:l2 level1 lfo11;tab-stops:list 36.0pt'><span
     style='mso-bidi-font-family:Arial'>To uniquely identify a particular COM
     object. A GUID that is assigned to a COM object is called a Class ID
     (CLSID). You use a CLSID when you want to create an instance of the
     associated COM object.</span><span style='font-family:Arial'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l2 level1 lfo11;tab-stops:list 36.0pt'><span
     style='mso-bidi-font-family:Arial'>To uniquely identify a particular COM
     interface. The GUID that is associated with a particular COM interface is
     called an Interface ID (IID). You use an IID when you request a particular
     interface from an object. An interface's IID will be the same, regardless
     of which object exposes the interface.</span><span style='font-family:
     Arial'><o:p></o:p></span></li>
</ol>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>For convenience,
documentation normally refers to objects and interfaces by a descriptive name
such as </span><span style='font-family:"Courier New"'>IDirect3D8</span><span
style='mso-bidi-font-family:Arial'>. In the context of the documentation, there
is rarely any danger of confusion. However, strictly speaking, there is no
guarantee that another object or interface does not have the same descriptive
name. The only unambiguous way to refer to a particular object or interface is
by its GUID.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Although GUIDs are
structures, they are often expressed as an equivalent string. The general
format of the string form of a GUID is </span><span style='font-family:"Courier New"'>&quot;{VVVVVVVV-WWWW-XXXX-YYYY-ZZZZZZZZZZZZ}&quot;</span><span
style='mso-bidi-font-family:Arial'>, where each letter corresponds to a
hexadecimal integer. For example, the string form of the IID for the IDirect3D8
interface is:</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>{1DD9E8DA-1C77-4D40-B0CF-98FEFDFF9512}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Because the actual
GUID is somewhat clumsy to use and easy to mistype, an equivalent name is
usually provided as well. You can use this name instead of the actual structure
when you call functions such as </span><span style='font-family:"Courier New"'>CoCreateInstance</span><span
style='mso-bidi-font-family:Arial'>. The customary naming convention is to
prepend either </span><span style='font-family:"Courier New"'>IID_</span><span
style='mso-bidi-font-family:Arial'> or </span><span style='font-family:"Courier New"'>CLSID_</span><span
style='mso-bidi-font-family:Arial'> to the descriptive name of the interface or
object, respectively. For example, the name of the </span><span
style='font-family:"Courier New"'>IDirect3D8</span><span style='mso-bidi-font-family:
Arial'> interface's IID is </span><span style='font-family:"Courier New"'>IID_IDirect3D8</span><span
style='mso-bidi-font-family:Arial'>.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<h3><a name="_Toc515331872"></a><a name="_Toc515374550"><span style='mso-bookmark:
_Toc515331872'>HRESULT Values</span></a></h3>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>All COM methods
return a 32-bit integer called an HRESULT. With most methods, the HRESULT is
essentially a structure that contains two separate pieces of information:</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal style='mso-list:l4 level1 lfo14;tab-stops:list 36.0pt'><span
     style='mso-bidi-font-family:Arial'>Whether the method succeeded or failed.</span><span
     style='font-family:Arial'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo14;tab-stops:list 36.0pt'><span
     style='mso-bidi-font-family:Arial'>More detailed information about the
     outcome of the operation supported by the method.</span><span
     style='font-family:Arial'><o:p></o:p></span></li>
</ol>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Some methods return
HRESULT values only from the standard set defined in win.h. However, methods
are free to return custom HRESULT values with more specialized information.
These values are normally documented on the method's reference page.<a
style='mso-footnote-id:ftn2' href="#_ftn2" name="_ftnref2" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]>[2]<![endif]></span></span></a></span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>While HRESULT
values are often used to return error information, you should not think of them
as error codes. The fact that the bit that indicates success or failure is
stored separately from the bits that contain the detailed information allows
HRESULT values to have any number of success and failure codes. By convention,
success codes are given names with an S_ prefix, and failure codes with an E_
prefix. For example, the two most commonly used codes are S_OK and E_FAIL,
which indicate simple success or failure, respectively. </span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>The fact that COM
methods may return a variety of success or failure codes means that you have to
be careful how you test the HRESULT value. For example, consider a hypothetical
method with documented return values of S_OK if successful and E_FAIL if not.
However, remember that the method may also return other failure or success
codes. The following code fragment illustrates the danger of using a simple
test. The hr value is the HRESULT that was returned by the method.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>if(hr == E_FAIL)<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>//Handle the failure<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>else<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>//Handle the success<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>As long as the method
returns only E_FAIL to indicate failure, this test will work properly. However,
the method might also return an error value such as E_NOTIMPL or E_INVALIDARG.
That value would be interpreted as a success, perhaps causing <i>your</i>
application to fail.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>If you need
detailed information on the outcome of the method call, you will need to test
each relevant HRESULT value. However, you may be interested only in whether the
method succeeded or failed. A robust way to test whether an HRESULT value
indicates success or failure is to pass the value to the one of the following
macros, defined in Win.h.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal style='mso-list:l9 level1 lfo17;tab-stops:list 36.0pt'><span
     style='mso-bidi-font-family:Arial'>The SUCCEEDED macro returns TRUE for a
     success code and FALSE for a failure code.</span><span style='font-family:
     Arial'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo17;tab-stops:list 36.0pt'><span
     style='mso-bidi-font-family:Arial'>The FAILED macro returns TRUE for a
     failure code and FALSE for a success code.</span><span style='font-family:
     Arial'><o:p></o:p></span></li>
</ol>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>You can fix the
preceding code fragment by using the FAILED macro.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>if(FAILED(hr))<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>//Handle the failure<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>else<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>//Handle the success<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>This code fragment
properly treats E_NOTIMPL and E_INVALIDARG as failures.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Although most COM
methods return structured HRESULT values, a small number use the HRESULT to
return a simple integer. Implicitly, these methods are always successful. If
you pass an HRESULT of this sort to the SUCCESS macro, the macro will always
return TRUE. A commonly used example is the IUnknown::Release method. This
method decrements an object's reference count by one and returns the current
reference count. See Managing the Object's Lifetime for a discussion of
reference counting.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331873"></a><a name="_Toc515374551"><span style='mso-bookmark:
_Toc515331873'>The Address of a Pointer</span></a></h3>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>If you look at a few
COM method reference pages, you will probably run across something like the
following:</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>HRESULT
CreateDevice(<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>...,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>IDirect3DDevice8** ppReturnedDeviceInterface
<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>While a normal
pointer is quite familiar to any lcc-win32 developer, COM often uses an
additional level of indirection. This second level of indirection is indicated
by a &quot;</span><span style='font-family:"Courier New"'>**</span><span
style='mso-bidi-font-family:Arial'>&quot; following the type declaration, and
the variable name typically has a &quot;pp&quot; prefix. For the example given
above, ppReturnedDeviceInterface parameter is typically referred to as the
address of a pointer to an IDirect3DDevice8 interface.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>You do not access a
COM object's methods directly. Instead, you must obtain a pointer to an
interface that exposes the method. To invoke the method, you use essentially
the lpVtbl member of the interface structure, and then you dereference that
pointer. For example, to invoke the </span><span style='font-family:"Courier New"'>IMyInterface::DoSomething</span><span
style='mso-bidi-font-family:Arial'> method, you would use the following syntax.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>IMyInterface
*pMyIface;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>pMyIface-&gt;lpVtbl-&gt;DoSomething(pMyIface,
...);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Note that this is
slightly different to the documentation for C++. In C++ you would write:</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>IMyInterface
*pMyIface;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>pMyIface-&gt;DoSomething(...);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>In C++, the
compiler makes the lpVtbl indirection, and adds an invisible parameter to the
method(s call. Since in C we surely do not WANT the compiler writing code
behind our backs, we do that ourselves when we want it.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>The need for a
second level of indirection comes from the fact that you do not create
interface pointers directly. You must call one of variety of methods, such as
the </span><span style='font-family:"Courier New"'>CreateDevice</span><span
style='mso-bidi-font-family:Arial'> method shown above. To use such a method to
obtain an interface pointer, you declare a variable as a pointer to the desired
interface, and pass the address of that variable to the method. In other words,
you pass the method the address of a pointer. When the method returns, the
variable will point to the requested interface, and you can use that pointer to
call any of the interface's methods. See Obtaining and Using COM Interfaces for
further discussion of how to use interface pointers.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h2><a name="_Toc515331874"></a><a name="_Toc515374552"><span style='mso-bookmark:
_Toc515331874'>Creating a COM object</span></a></h2>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>There are several
ways to create COM objects. The two most common ones used in DirectX
programming are:</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal style='mso-list:l8 level1 lfo20;tab-stops:list 36.0pt'><span
     style='mso-bidi-font-family:Arial'>Directly, by passing the object's CLSID
     to the CoCreateInstance function, as shown in the example above. The function
     will create an instance of the object, and it will return a pointer to an
     interface that you specify.</span><span style='font-family:Arial'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l8 level1 lfo20;tab-stops:list 36.0pt'><span
     style='mso-bidi-font-family:Arial'>Indirectly, by calling a DirectX method
     or function that creates the object for you. The method creates the object
     and returns an interface on the object. When you create an object this
     way, you usually cannot specify which interface should be returned. </span><span
     style='font-family:Arial'><o:p></o:p></span></li>
</ol>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Before you create
any objects, COM must be initialized by calling the “</span><span
style='font-family:"Courier New"'>CoInitialize</span><span style='mso-bidi-font-family:
Arial'>” function. If you are creating objects indirectly, the object creation
method will handle this task. If you need to create an object with “</span><span
style='font-family:"Courier New"'>CoCreateInstance</span><span
style='mso-bidi-font-family:Arial'>”, you must call </span><span
style='font-family:"Courier New"'>CoInitialize</span><span style='mso-bidi-font-family:
Arial'> explicitly. When you are finished, COM must be uninitialized by calling
</span><span style='font-family:"Courier New"'>CoUninitialize</span><span
style='mso-bidi-font-family:Arial'>. If you make a call to </span><span
style='font-family:"Courier New"'>CoInitialize</span><span style='mso-bidi-font-family:
Arial'> you must match it with a call to </span><span style='font-family:"Courier New"'>CoUninitialize</span><span
style='mso-bidi-font-family:Arial'>. Typically, applications that need to
explicitly initialize COM do so in their startup routine, and they uninitialize
COM in their cleanup routine, or at the beginning and end of the WinMain
procedure.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>To create a new
instance of a COM object with </span><span style='font-family:"Courier New"'>CoCreateInstance</span><span
style='mso-bidi-font-family:Arial'>, you must have the object's CLSID. If this
CLSID is in the header files, or otherwise publicly available, you will find it
in the reference documentation or the appropriate header file. </span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>The </span><span
style='font-family:"Courier New"'>CoCreateInstance</span><span
style='mso-bidi-font-family:Arial'> function has five parameters. For the COM
objects you will be using with DirectX, you can normally set the parameters as
follows</span><span style='font-family:Arial'><o:p></o:p></span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal style='mso-list:l5 level1 lfo23;tab-stops:list 36.0pt'><span
     style='font-family:"Courier New"'>rclsid</span><span style='mso-bidi-font-family:
     Arial'>. A reference to a CLSID. You can use a direct reference, since
     lcc-win32 supports this, or just a normal pointer. In both cases, the
     address of the CLSID will be passed to the function. </span><span
     style='font-family:Arial'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo23;tab-stops:list 36.0pt'><span
     style='font-family:"Courier New"'>pUnkOuter</span><span style='mso-bidi-font-family:
     Arial'>. Set this parameter to NULL. It is used only if you are
     aggregating objects.</span><span style='font-family:Arial'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo23;tab-stops:list 36.0pt'><span
     style='font-family:"Courier New"'>dwClsContext</span><span
     style='mso-bidi-font-family:Arial'>. Set this parameter to </span><span
     style='font-family:"Courier New"'>CLSCTX_INPROC_SERVER</span><span
     style='mso-bidi-font-family:Arial'>. This setting indicates that the
     object is implemented as a DLL and will run as part of your application's
     process.</span><span style='font-family:Arial'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo23;tab-stops:list 36.0pt'><span
     style='font-family:"Courier New"'>riid</span><span style='mso-bidi-font-family:
     Arial'>. Set this parameter to the IID of the interface that you would
     like to have returned. The function will create the object, and it will
     return the requested interface pointer in the </span><span
     style='font-family:"Courier New"'>ppv</span><span style='mso-bidi-font-family:
     Arial'> parameter.</span><span style='font-family:Arial'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l5 level1 lfo23;tab-stops:list 36.0pt'><span
     style='font-family:"Courier New"'>ppv</span><span style='mso-bidi-font-family:
     Arial'>. Set this parameter to the address of a pointer that will be set
     to the interface specified by riid when the function returns. This
     variable should be declared as a pointer to the requested interface, and
     the reference to the pointer in the parameter list should be cast as
     (LPVOID *).</span><span style='font-family:Arial'><o:p></o:p></span></li>
</ol>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>For example, the
following code fragment creates a new instance of the </span><span
style='font-family:"Courier New"'>DirectPlay8 </span><span style='mso-bidi-font-family:
Arial'>object, and it returns a pointer to the </span><span style='font-family:
"Courier New"'>IDirectPlay8Pee</span><span style='mso-bidi-font-family:Arial'>r
interface in the </span><span style='font-family:"Courier New"'>g_pDP</span><span
style='mso-bidi-font-family:Arial'> variable. If an error occurs, a message box
is displayed, and the application terminates.</span><span style='font-family:
Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>IDirectPlay8Peer*<span
style="mso-spacerun: yes">  </span>g_pDP = NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>CoInitialize( NULL
);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>hr =
CoCreateInstance(&amp;CLSID_DirectPlay8,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
style='font-family:"Courier New"'><span style="mso-spacerun: yes"> </span>NULL,
CLSCTX_INPROC_SERVER,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">          </span>&amp;IID_IDirectPlay8Peer, (LPVOID*)
&amp;g_pDP );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>if( FAILED( hr ) ) <o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>MessageBox( NULL,<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span style='font-family:"Courier New"'>TEXT(&quot;Failed
Creating IDirectPlay8Peer. &quot;),<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">     </span>TEXT(&quot;DirectPlay Sample&quot;),
MB_OK | MB_ICONERROR );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>return FALSE;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Creating an object
indirectly is usually much simpler. You pass the object creation method the
address of an interface pointer. The method then creates the object and returns
an interface pointer. When you create an object indirectly, you typically
cannot choose which interface the method will return. However, you can often
specify a variety of things about how the object should be created. For
example, the following code fragment calls the </span><span style='font-family:
"Courier New"'>IDirect3D8::CreateDevice</span><span style='mso-bidi-font-family:
Arial'> method discussed earlier to create a device object to represent a
display adapter. It returns a pointer to the object's </span><span
style='font-family:"Courier New"'>IDirect3DDevice8</span><span
style='mso-bidi-font-family:Arial'> interface. The first four parameters
provide a variety of information needed to create the object, and the fifth
parameter receives the interface pointer. See the reference documentation for
details.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>IDirect3DDevice8
*g_pd3dDevice = NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>if(FAILED(g_pD3D-&gt;lpVtbl-&gt;CreateDevice(g_pD3D,<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span style='font-family:"Courier New"'>D3DADAPTER_DEFAULT,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">     </span>3DDEVTYPE_HAL,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt'><span style='font-family:"Courier New"'>hWnd,<span
style="mso-spacerun: yes">                           
</span>D3DCREATE_SOFTWARE_VERTEXPROCESSING,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">     </span>&amp;d3dpp,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">     </span>&amp;g_pd3dDevice )))<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>return E_FAIL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h2><a name="_Toc515331875"></a><a name="_Toc515374553"><span style='mso-bookmark:
_Toc515331875'>Using COM Interfaces</span></a></h2>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>When the object is
created, the creation method returns an interface pointer. You can then use
that pointer to access any of the interface's methods. The syntax is identical
to that used with a pointer to a C++ method. The following code fragment
extends the example given in the previous section. After creating the
DirectPlay8 object, the example uses the IDirectPlay8Peer interface pointer
returned by CoCreateInstance to initialize the object by calling the
IDirectPlay8Peer::Initialize method. Error correction code is omitted for
clarity.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>IDirectPlay8Peer*<span
style="mso-spacerun: yes">  </span>g_pDP = NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>CoInitialize( NULL
);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>hr =
CoCreateInstance(CLSID_DirectPlay8,NULL,<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span style='font-family:"Courier New"'>CLSCTX_INPROC_SERVER,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>IID_IDirectPlay8Peer, (LPVOID*) &amp;g_pDP
);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>hr =
g_pDP-&gt;lpVtbl-&gt;Initialize(g_pDP, NULL, <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
style='font-family:"Courier New"'>DirectPlayMessageHandler, 0 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331876"></a><a name="_Toc515374554"><span style='mso-bookmark:
_Toc515331876'>Requesting Additional Interfaces</span></a></h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>In many cases, the interface
pointer that you receive from the creation method may be the only one that you
need. In fact, it is not uncommon for an object to export only one interface
other than <span style='font-family:"Courier New";mso-bidi-font-weight:bold'>IUnknown</span>.
However, many objects export multiple interfaces, and you may need pointers to
several of them. If you need more interfaces than the one returned by the
creation method, there is no need to create a new object. Instead, you request
another interface pointer by using the object's <span style='font-family:"Courier New";
mso-bidi-font-weight:bold'>IUnknown::QueryInterface</span> method. <span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you create your object with <span
style='font-family:"Courier New";mso-bidi-font-weight:bold'>CoCreateInstance</span>,
you can request an <span style='font-family:"Courier New";mso-bidi-font-weight:
bold'>IUnknown</span> interface pointer, and then call <span style='font-family:
"Courier New";mso-bidi-font-weight:bold'>IUnknown::QueryInterface</span> to
request every interface you need. However, this approach is inconvenient if you
need only a single interface, and it doesn't work at all if you use an object
creation method that does not allow you to specify which interface pointer
should be returned. In practice, you usually don't need to obtain an explicit <span
style='font-family:"Courier New";mso-bidi-font-weight:bold'>IUnknown</span>
pointer because all COM interfaces inherit from or <i style='mso-bidi-font-style:
normal'>extend</i> the <span style='font-family:"Courier New";mso-bidi-font-weight:
bold'>IUnknown</span> interface.<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Extending an interface is
similar to inheriting in object oriented programming. The child interface
exposes all of the parent interface's methods, plus one or more of its own. In
fact, you will often see &quot;inherits from&quot; used instead of
&quot;extends&quot;. What you need to remember is that the inheritance is
internal to the object. You can use the child interface to call any of the
child's or the parent's methods.<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>Because all interfaces are
children of <span style='font-family:"Courier New";mso-bidi-font-weight:bold'>IUnknown</span>
you can use any of the interface pointers you already have for the object to
call <span style='font-family:"Courier New";mso-bidi-font-weight:bold'>QueryInterface</span>.
When you do so, you must provide the IID of the interface you are requesting
and the address of a pointer that will contain the interface pointer when the
method returns. <span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>For example, the following code
fragment calls <span style='font-family:"Courier New";mso-bidi-font-weight:
bold'>IDirectSound8::CreateSoundBuffer</span> to create a primary sound buffer
object. This object exposes several interfaces. The <span style='font-family:
"Courier New";mso-bidi-font-weight:bold'>CreateSoundBuffer </span>method
returns an <span style='font-family:"Courier New";mso-bidi-font-weight:bold'>IDirectSoundBuffer8</span>
interface. The subsequent code then uses the <span style='font-family:"Courier New";
mso-bidi-font-weight:bold'>IDirectSoundBuffer8</span> interface to call <span
style='font-family:"Courier New";mso-bidi-font-weight:bold'>QueryInterface</span>
to request an <span style='font-family:"Courier New";mso-bidi-font-weight:bold'>IDirectSound3DListener8</span>
interface.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>IDirectSoundBuffer8*
pDSBPrimary = NULL;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>IDirectSound3DListener8*
pDSListener;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>if(FAILED(hr
= g_pDS-&gt;lpVtbl-&gt;CreateSoundBuffer(g_pDS,<o:p></o:p></span></p>

<p class=Ex style='margin-left:78.0pt;text-indent:30.0pt;line-height:12.0pt;
mso-line-height-rule:exactly'><span style='font-size:12.0pt;mso-bidi-font-size:
10.0pt;font-family:"Courier New"'><span style="mso-spacerun:
yes"> </span>&amp;dsbd, &amp;pDSBPrimary, NULL )))<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>return hr;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>if(FAILED(hr
= pDSBPrimary-&gt;lpVtbl-&gt;QueryInterface( <o:p></o:p></span></p>

<p class=Ex style='text-indent:30.0pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:
"Courier New"'>gDSBPrimary,&amp;IID_IDirectSound3DListener8,<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>(LPVOID *)&amp;pDSListener)))<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>return hr;<o:p></o:p></span></p>

<h3><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></h3>

<h3><a name="_Toc515331877"></a><a name="_Toc515374555"><span style='mso-bookmark:
_Toc515331877'>Managing a COM Object's Lifetime</span></a></h3>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When an object is created, the
system allocates the necessary memory resources. When an object is no longer
needed, it should be destroyed. The system can use that memory for other
purposes. COM does not enable you to create or destroy objects directly. The
reason for this practice is that the same object may be used by more than one
application. If one of those applications were to destroy the object, the other
applications would probably fail. Instead COM uses a system of <i
style='mso-bidi-font-style:normal'>reference counting</i>, to control an
object's lifetime.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>An object's reference count is
the number of times one of its interfaces has been requested. Each time an
interface is requested, the reference count is incremented. An application <i
style='mso-bidi-font-style:normal'>releases </i>an interface when that
interface is no longer needed, decrementing the reference count. As long as the
reference count is greater than zero, the object remains in memory. When the
reference count reaches zero, the object destroys itself. You don't need to
know anything about the reference count of an object. As long as you obtain and
release an object's interfaces properly, the object will have the appropriate
lifetime.<a style='mso-footnote-id:ftn3' href="#_ftn3" name="_ftnref3" title=""><span
class=MsoFootnoteReference><span style='mso-special-character:footnote'><![if !supportFootnotes]>[3]<![endif]></span></span></a><span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331878"></a><a name="_Toc515374556"><span style='mso-bookmark:
_Toc515331878'>Incrementing and Decrementing the Reference Count</span></a></h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>Whenever you obtain a new
interface pointer, the reference count must be incremented by a call to <span
style='font-family:"Courier New";mso-bidi-font-weight:bold'>IUnknown::AddRef</span>.
However, your application does not usually need to call this method. If you
obtain an interface pointer by calling an object creation method, or by calling
<span style='font-family:"Courier New";mso-bidi-font-weight:bold'>IUnknown::QueryInterface</span>,
the object will automatically increment the reference count. However, if you
create an interface pointer in some other way, such as copying an existing
pointer, you must explicitly call <span style='font-family:"Courier New";
mso-bidi-font-weight:bold'>IUnknown::AddRef</span>. Otherwise, when you release
the original interface pointer, the object may be destroyed even though you may
still need to use the copy of the pointer.<span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You must release all interface
pointers, regardless of whether you or the object incremented the reference
count. When you no longer need an interface pointer, call <span
style='font-family:"Courier New";mso-bidi-font-weight:bold'>IUnknown::Release</span>
to decrement the reference count. A common practice is to initialize all
interface pointers to NULL, and set them back to NULL when they are released.
That allows you to test all interface pointers in your cleanup code. Those that
are non-NULL are still active and must be released before you terminate the
application.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following code fragment
extends the sample discussed in Requesting Additional Interfaces to illustrate
how to handle reference counting.<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>IDirectSoundBuffer8*
pDSBPrimary = NULL;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>IDirectSound3DListener8*
pDSListener = NULL;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>IDirectSound3DListener8*
pDSListener2 = NULL;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>Create the
object and obtain an additional interface.<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>The object
increments the reference count.<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>if(FAILED(hr
= g_pDS-&gt;lpVtbl-&gt;CreateSoundBuffer(g_pDS,<o:p></o:p></span></p>

<p class=Ex style='text-indent:30.0pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:
"Courier New"'><span style="mso-spacerun: yes"> </span>&amp;dsbd,
&amp;pDSBPrimary, NULL )))<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>return hr;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>if(FAILED(hr=pDSBPrimary-&gt;lpVtbl-&gt;QueryInterface(
<o:p></o:p></span></p>

<p class=Ex style='text-indent:30.0pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:
"Courier New"'>pDSBPrimary,&amp;IID_IDirectSound3DListener8,<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">   </span>(LPVOID *)&amp;pDSListener)))<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>return hr;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>Make a
copy of the IDirectSound3DListener8 interface pointer.</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>Call AddRef
to increment the reference count and to ensure that</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>the object
is not destroyed prematurely<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>pDSListener2
= pDSListener;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>pDSListener2-&gt;lpVtbl-&gt;AddRef(pDSListener2);<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>Cleanup
code. Check to see if the pointers are still active.</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>//</span><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial'>If they
are, call Release to release the interface.<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>if(pDSBPrimary
!= NULL)<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes"> 
</span>pDSBPrimary-&gt;lpVtbl-&gt;Release(pDSBPrimary);<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>pDSBPrimary = NULL;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>if(pDSListener
!= NULL)<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes"> 
</span>pDSListener-&gt;lpVtbl-&gt;Release(pDSListener);<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>pDSListener = NULL;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>if(pDSListener2
!= NULL)<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes"> </span><span style="mso-spacerun:
yes"> </span>pDSListener2-&gt;lpVtbl-&gt;Release(pDSListener2);<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">  </span>pDSListener2 = NULL;<o:p></o:p></span></p>

<p class=Ex style='line-height:12.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331879"></a><a name="_Toc515374557"><span style='mso-bookmark:
_Toc515331879'>Using macros to call DirectX methods.</span></a></h3>

<p class=MsoNormal>Many of the DirectX interfaces have macros defined for each
method that make using the methods in your applications simpler. <span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>For example, the following code fragment from the d3d8.h
header file shows the definitions of the C macros for the
IDirect3D8::GetAdapterIdentifier method.<span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>#define
IDirect3D8_GetAdapterIdentifier(p,a,b,c) \<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
style='font-family:"Courier New"'>(p)-lpVtbl-&gt;GetAdapterIdentifier(a,b,c)<o:p></o:p></span></p>

<p class=MsoNormal>...<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>To use one of these macros, you must first obtain a pointer
to the associated interface. The first parameter of the macro must be set to
that pointer. The remaining parameters map to the method's parameters. The
macro's return value is the HRESULT value that is returned by the method. The
following code fragment uses a macro to call the
IDirect3D8::GetAdapterIdentifier method. pD3D is a pointer to an IDirect3D8
interface.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span lang=FR style='font-family:"Courier New";mso-ansi-language:
FR'>hr = IDirect3D8_GetAdapterIdentifier(pD3D,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=FR style='font-family:"Courier New";mso-ansi-language:
FR'><span style="mso-spacerun: yes">                                    
</span>Adapter,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=FR style='font-family:"Courier New";mso-ansi-language:
FR'><span style="mso-spacerun: yes">                                    
</span></span><span style='font-family:"Courier New"'>dwFlags,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">                                    
</span>pIdentifier);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331880"></a><a name="_Toc515374558"><span style='mso-bookmark:
_Toc515331880'>The IUnknown interface</span></a></h3>

<p class=MsoNormal>All COM objects support an interface called <span
style='font-family:"Courier New"'>IUnknown</span>. This interface provides DirectX
with control of the object's lifetime and the ability to retrieve other
interfaces implemented by the object.<span style='font-family:"Courier New"'>
IUnknown</span> has three methods.<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal style='mso-list:l6 level1 lfo26;tab-stops:list 36.0pt'><span
     style='font-family:"Courier New"'>AddRef</span> increments the object's
     reference count by 1 when an interface or another application binds itself
     to the object.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l6 level1 lfo26;tab-stops:list 36.0pt'><span
     style='font-family:"Courier New"'>QueryInterface</span> queries the object
     about the features that it supports by requesting pointers to a specific
     interface.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l6 level1 lfo26;tab-stops:list 36.0pt'><span
     style='font-family:"Courier New"'>Release</span> decrements the object's
     reference count by 1. When the count reaches 0, the object is deallocated.<span
     style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></li>
</ol>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>The <span style='font-family:"Courier New"'>AddRef</span>
and <span style='font-family:"Courier New"'>Release</span> methods maintain an
object's reference count. For example, if you create a Direct3D object, the
object's reference count is set to 1. Every time a function returns a pointer
to an interface for that object, the function must call <span style='font-family:
"Courier New"'>AddRef</span> through that pointer to increment the reference
count. Match each <span style='font-family:"Courier New"'>AddRef</span> call
with a call to <span style='font-family:"Courier New"'>Release</span>. Before
the pointer can be destroyed, you must call <span style='font-family:"Courier New"'>Release</span>
through that pointer. After an object's reference count reaches 0, the object
is destroyed, and all interfaces to it become invalid.<span style='font-family:
Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal>The <span style='font-family:"Courier New"'>QueryInterface</span>
method determines whether an object supports a specific interface. If an object
supports an interface, <span style='font-family:"Courier New"'>QueryInterface</span>
returns a pointer to that interface. You then can use the methods of that
interface to communicate with the object. If <span style='font-family:"Courier New"'>QueryInterface</span>
successfully returns a pointer to an interface, it implicitly calls <span
style='font-family:"Courier New"'>AddRef</span> to increment the reference
count, so your application must call <span style='font-family:"Courier New"'>Release</span>
to decrement the reference count before destroying the pointer to the interface.<span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331881"></a><a name="_Toc515374559"><span style='mso-bookmark:
_Toc515331881'>Using Callback functions</span></a></h3>

<p class=MsoNormal>A callback function is essentially an event handler that is
implemented by an application and called by the system. Windows applications
typically implement multiple callback functions, each one designed for a
particular set of events. When an event occurs, the system notifies the
application by calling the appropriate callback function. The callback function
also usually has a parameter list that the system can use to pass the
application more detailed information about the event. The most common example
of a callback function is the window procedure. This function is used by the
system to pass Windows messages to the applications that owns the window. <span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>DirectX uses callback functions for a variety of purposes.
For example, your system supports multiple devices. DirectInput represents each
device by a device object, that contains the details of the device's
capabilities. Your application will typically need to enumerate the available
devices and to examine the device objects in order to handle user input
properly. To do this enumeration, you must implement a <span style='font-family:
"Courier New"'>DIEnumDeviceObjectsCallback</span> callback function.<span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>You start the enumeration process by calling <span
style='font-family:"Courier New"'>IDirectInputDevice8::EnumObjects</span> and
passing the method a pointer to your <span style='font-family:"Courier New"'>DIEnumDeviceObjectsCallback</span>
callback function. The system will call this function once for each device, and
it will pass in a <span style='font-family:"Courier New"'>DIDEVICEOBJECTINSTANCE</span>
structure containing information about the device's capabilities. After your
callback function has processed the information, it can return <span
style='font-family:"Courier New"'>DIENUM_CONTINUE</span> to request the next
device object, or <span style='font-family:"Courier New"'>DIENUM_STOP</span> to
stop the enumeration.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>DirectX uses a number of other callback functions for a
variety of purposes. For details, see the documentation for the particular DirectX
component.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331882"></a><a name="_Toc515374560"><span style='mso-bookmark:
_Toc515331882'>Implementing a Callback Function</span></a></h3>

<p class=MsoNormal>Because callback functions have different purposes and
usage, they are documented in the appropriate Reference section in much the
same way as a regular function. However, a callback function reference is
essentially a template that describes how to implement the function, not a
normal API reference. The callback function reference provides the following
information:<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<ol style='margin-top:0cm' start=1 type=1>
 <li class=MsoNormal style='mso-list:l1 level1 lfo29;tab-stops:list 36.0pt'>How
     the function is used<span style='font-family:Arial;mso-bidi-font-family:
     "Times New Roman"'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo29;tab-stops:list 36.0pt'>The
     function's syntax<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo29;tab-stops:list 36.0pt'>An
     explanation of the information that will be contained by each parameter<span
     style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo29;tab-stops:list 36.0pt'>An
     explanation of the possible return values<span style='font-family:Arial;
     mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></li>
</ol>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>You should declare the function as a <span style='font-family:
"Courier New"'>CALLBACK</span> or <span style='font-family:"Courier New"'>WINAPI</span>
type. Either type is acceptable. You can use any function name that you wish.
The name used in the documentation is simply a convenient label for a
particular callback function.<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>Implement the function according to the description in the
reference. The implementation details will depend on the particular function
and the requirements of your application. See the sample code for some examples
of how to implement various callback functions.<span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>Pass a pointer to the function to the appropriate DirectX
component. The DirectX component can then use the function pointer to call the
function. The way in which you pass this pointer varies from function to
function, so you should see the particular function's reference for details. <span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>The following code fragment is borrowed from the DirectInput
Joystick sample. It sketches out the essential elements of a <span
style='font-family:"Courier New"'>DIEnumDeviceObjectsCallback</span> implementation
that is used to enumerate the axes of a joystick.<span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>//</span><span
style='mso-bidi-font-family:Arial'>The function declaration</span><span
style='font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>BOOL CALLBACK
EnumAxesCallback(<o:p></o:p></span></p>

<p class=MsoNormal style='text-indent:36.0pt'><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes"> </span></span><span lang=FR style='font-family:"Courier New";
mso-ansi-language:FR'>const DIDEVICEOBJECTINSTANCE* pdidoi,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=FR style='font-family:"Courier New";mso-ansi-language:
FR'><span style="mso-spacerun: yes">     </span>VOID* pContext );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>//</span><span
style='mso-bidi-font-family:Arial'>Pass the function pointer to DirectInput by
calling the </span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>//</span><span
style='mso-bidi-font-family:Arial'>IDirectInputDevice8::EnumObjects method</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>if ( FAILED( hr =
g_pJoystick-&gt;lpVtbl-&gt;EnumObjects( <o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
style='font-family:"Courier New"'>g_pJoystick,<o:p></o:p></span></p>

<p class=MsoNormal style='margin-left:36.0pt;text-indent:36.0pt'><span
style='font-family:"Courier New"'>EnumAxesCallback, <o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">          </span>(VOID*)hDlg,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes">          </span>DIDFT_AXIS )));<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>...<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>//The function
implementation<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>BOOL CALLBACK
EnumAxesCallback(<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'><span
style="mso-spacerun: yes"> </span></span><span lang=FR style='font-family:"Courier New";
mso-ansi-language:FR'>const DIDEVICEOBJECTINSTANCE* pdidoi,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=FR style='font-family:"Courier New";mso-ansi-language:
FR'><span style="mso-spacerun: yes">                               
</span>VOID* pContext )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>//</span><span
style='mso-bidi-font-family:Arial'>Process the information passed in through
the two parameters</span><span style='font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>//</span><span
style='mso-bidi-font-family:Arial'>Return DIENUM_CONTINUE to request the next
device object</span><span style='font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>//</span><span
style='mso-bidi-font-family:Arial'>Return DIENUM_STOP to stop the enumeration</span><span
style='font-family:"Courier New"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331883"></a><a name="_Toc515374561"><span style='mso-bookmark:
_Toc515331883'>Version Checking</span></a></h3>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>Applications
sometimes need to know which version of DirectX is currently available on the
system. For example, if an older version of DirectX is on the system, your
application may need to scale itself to the capabilities of that version or
install the most recent version.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>There is no direct
way to obtain the DirectX version number. However, each version has a
characteristic set of objects and interfaces. Because any version of DirectX
supports all previous versions, this set of interfaces and objects will be
supported by the version in which they are introduced and all subsequent
versions. Thus, the preferred way to determine whether your desired version is
available is to test for its characteristic objects or interfaces. As long as those
are present, your application will work normally even though you might be using
a more recent version of DirectX.</span><span style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='mso-bidi-font-family:Arial'>For example,
suppose you need version 6.1 support. The DirectMusic object
(CLSID_DirectMusic) was introduced in DirectX version 6.1. You can test for the
presence of the DirectMusic object by attempting to create it with
CoCreateInstance. If you are successful, you have version 6.1 or later, and you
will be able to use all the DirectX 6.1 capabilities.</span><span
style='font-family:Arial'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>Here is a function that makes all the tests for you. You
will find the complete application in the samples distributed with lcc-win32,
in the directory lcc\examples\directx\dxver<span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//-----------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>// Name: GetDXVersion()<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>// Desc: This function returns the DirectX version
number as follows:<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>0x0000 = No DirectX installed<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>0x0100 = DirectX version 1 installed<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>0x0200 = DirectX 2 installed<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>0x0300 = DirectX 3 installed<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">          </span>0x0500
= At least DirectX 5 installed.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>0x0600 = At least DirectX 6 installed.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>0x0601 = At least DirectX 6.1 installed.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>0x0700 = At least DirectX 7 installed.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>0x0800 = At least DirectX 8 installed.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>// <o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">     </span><span
style="mso-spacerun: yes">  </span>Please note that this code is intended as a
general guideline. Your<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">       </span>app
will probably be able to simply query for functionality (via<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">      
</span>QueryInterface) for one or two components.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">      
</span>Please also note:<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>&quot;if( dwDXVersion != 0x500 ) return FALSE;&quot; is VERY BAD. <o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">         
</span>&quot;if( dwDXVersion &lt;<span style="mso-spacerun: yes">  </span>0x500
) return FALSE;&quot; is MUCH BETTER.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//<span style="mso-spacerun: yes">       </span>to
ensure your app will run on future releases of DirectX.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>//-----------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>DWORD GetDXVersion()<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>DIRECTDRAWCREATE<span style="mso-spacerun: yes">    
</span>DirectDrawCreate<span style="mso-spacerun: yes">   </span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>DIRECTDRAWCREATEEX<span style="mso-spacerun: yes">  
</span>DirectDrawCreateEx = NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>DIRECTINPUTCREATE<span style="mso-spacerun: yes">   
</span>DirectInputCreate<span style="mso-spacerun: yes">  </span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>HINSTANCE<span style="mso-spacerun: yes">           
</span>hDDrawDLL<span style="mso-spacerun: yes">          </span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>HINSTANCE<span style="mso-spacerun: yes">          </span><span
style="mso-spacerun: yes">  </span>hDInputDLL<span style="mso-spacerun:
yes">         </span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>HINSTANCE<span style="mso-spacerun: yes">           
</span>hD3D8DLL<span style="mso-spacerun: yes">           </span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>LPDIRECTDRAW<span style="mso-spacerun: yes">         </span>pDDraw<span
style="mso-spacerun: yes">             </span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>LPDIRECTDRAW2<span style="mso-spacerun: yes">        </span>pDDraw2<span
style="mso-spacerun: yes">            </span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>LPDIRECTDRAWSURFACE<span style="mso-spacerun: yes">  </span>pSurf<span
style="mso-spacerun: yes">              </span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>LPDIRECTDRAWSURFACE3
pSurf3<span style="mso-spacerun: yes">             </span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>LPDIRECTDRAWSURFACE4 pSurf4<span style="mso-spacerun: yes">            
</span>= NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>DWORD<span style="mso-spacerun: yes">               
</span>dwDXVersion<span style="mso-spacerun: yes">        </span>= 0;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>HRESULT<span style="mso-spacerun: yes">              </span>hr;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// First
see if DDRAW.DLL even exists.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>hDDrawDLL
= LoadLibrary( &quot;DDRAW.DLL&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
hDDrawDLL == NULL )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>dwDXVersion = 0;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// See if
we can create the DirectDraw object.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>DirectDrawCreate
=(DIRECTDRAWCREATE)GetProcAddress(hDDrawDLL,&quot;DirectDrawCreate&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
DirectDrawCreate == NULL )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>dwDXVersion = 0;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>OutputDebugString( &quot;Couldn't LoadLibrary DDraw\r\n&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>hr =
DirectDrawCreate( NULL, &amp;pDDraw, NULL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
FAILED(hr) )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes"> </span><span
style="mso-spacerun: yes">   </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>dwDXVersion = 0;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>OutputDebugString( &quot;Couldn't create DDraw\r\n&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// So
DirectDraw exists.<span style="mso-spacerun: yes">  </span>We are at least DX1.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>dwDXVersion = 0x100;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// Let's see
if IID_IDirectDraw2 exists.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>hr =
pDDraw-&gt;lpVtbl-&gt;QueryInterface(pDDraw,&amp; IID_IDirectDraw2,
(VOID**)&amp;pDDraw2 );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
FAILED(hr) )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">        </span>// No
IDirectDraw2 exists... must be DX1<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>pDDraw-&gt;lpVtbl-&gt;Release(pDDraw);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>OutputDebugString( &quot;Couldn't QI DDraw2\r\n&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
IDirectDraw2 exists. We must be at least DX2<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>pDDraw2-&gt;lpVtbl-&gt;Release(pDDraw2);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>dwDXVersion = 0x200;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style='mso-tab-count:1'>       </span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
DirectX 3.0 Checks<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style='mso-tab-count:1'>       </span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
DirectInput was added for DX3<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>hDInputDLL = LoadLibrary( &quot;DINPUT.DLL&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if( hDInputDLL
== NULL )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">        </span>// No
DInput... must not be DX3<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>OutputDebugString( &quot;Couldn't LoadLibrary DInput\r\n&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>pDDraw-&gt;lpVtbl-&gt;Release(pDDraw);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>DirectInputCreate = (DIRECTINPUTCREATE)GetProcAddress( hDInputDLL,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun:
yes">                                                       
</span>&quot;DirectInputCreateA&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
DirectInputCreate == NULL )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">        </span>// No
DInput... must be DX2<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDInputDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       </span><span
style="mso-spacerun: yes"> </span>pDDraw-&gt;lpVtbl-&gt;Release(pDDraw);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>OutputDebugString( &quot;Couldn't GetProcAddress DInputCreate\r\n&quot;
);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
DirectInputCreate exists. We are at least DX3<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>dwDXVersion = 0x300;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>FreeLibrary( hDInputDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// Can do
checks for 3a vs 3b here<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
DirectX 5.0 Checks<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// We can
tell if DX5 is present by checking for the existence of<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
IDirectDrawSurface3. First, we need a surface to QI off of.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>DDSURFACEDESC ddsd;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>ZeroMemory( &amp;ddsd, sizeof(ddsd) );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>ddsd.dwSize<span style="mso-spacerun: yes">         </span>=
sizeof(ddsd);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>ddsd.dwFlags<span style="mso-spacerun: yes">        </span>= DDSD_CAPS;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>ddsd.ddsCaps.dwCaps = DDSCAPS_PRIMARYSURFACE;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>hr =
pDDraw-&gt;lpVtbl-&gt;SetCooperativeLevel(pDDraw, NULL, DDSCL_NORMAL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
FAILED(hr) )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">        </span>//
Failure. This means DDraw isn't properly installed.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>pDDraw-&gt;lpVtbl-&gt;Release(pDDraw);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>dwDXVersion = 0;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>OutputDebugString( &quot;Couldn't Set coop level\r\n&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>hr =
pDDraw-&gt;lpVtbl-&gt;CreateSurface(pDDraw, &amp;ddsd, &amp;pSurf, NULL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
FAILED(hr) )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes"> </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">        </span>//
Failure. This means DDraw isn't properly installed.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>pDDraw-&gt;lpVtbl-&gt;Release(pDDraw);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>dwDXVersion = 0;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>OutputDebugString( &quot;Couldn't CreateSurface\r\n&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   </span><span
style="mso-spacerun: yes"> </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// Query
for the IDirectDrawSurface3 interface<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
FAILED( pSurf-&gt;lpVtbl-&gt;QueryInterface(pSurf,&amp;IID_IDirectDrawSurface3,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun:
yes">                                       </span>(VOID**)&amp;pSurf3 ) ) )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>pDDraw-&gt;lpVtbl-&gt;Release(pDDraw);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// QI for
IDirectDrawSurface3 succeeded. We must be at least DX5<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>dwDXVersion = 0x500;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
DirectX 6.0 Checks<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// The
IDirectDrawSurface4 interface was introduced with DX 6.0<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
FAILED( pSurf-&gt;lpVtbl-&gt;QueryInterface(pSurf,&amp;
IID_IDirectDrawSurface4,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun:
yes">                            </span><span style="mso-spacerun:
yes">           </span>(VOID**)&amp;pSurf4 ) ) )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>pDDraw-&gt;lpVtbl-&gt;Release(pDDraw);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
IDirectDrawSurface4 was create successfully. We must be at least DX6<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>dwDXVersion = 0x600;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>pSurf-&gt;lpVtbl-&gt;Release(pSurf);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>pDDraw-&gt;lpVtbl-&gt;Release(pDDraw);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
DirectX 6.1 Checks<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// Check
for DMusic, which was introduced with DX6.1<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>LPDIRECTMUSIC pDMusic = NULL;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>CoInitialize( NULL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>hr =
CoCreateInstance(&amp;CLSID_DirectMusic, NULL, CLSCTX_INPROC_SERVER,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun:
yes">                           </span>&amp;IID_IDirectMusic,
(VOID**)&amp;pDMusic );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
FAILED(hr) )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>OutputDebugString( &quot;Couldn't create CLSID_DirectMusic\r\n&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
DirectMusic was created successfully. We must be at least DX6.1<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>dwDXVersion = 0x601;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>pDMusic-&gt;lpVtbl-&gt;Release(pDMusic);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>CoUninitialize();<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
DirectX 7.0 Checks<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// Check
for DirectX 7 by creating a DDraw7 object<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>LPDIRECTDRAW7 pDD7;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>DirectDrawCreateEx = (DIRECTDRAWCREATEEX)GetProcAddress( hDDrawDLL,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun:
yes">                            </span><span style="mso-spacerun:
yes">                           </span>&quot;DirectDrawCreateEx&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if( NULL
== DirectDrawCreateEx )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if(
FAILED( DirectDrawCreateEx( NULL, (VOID**)&amp;pDD7,&amp; IID_IDirectDraw7,<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">                
</span><span style="mso-spacerun: yes">                   </span>NULL ) ) )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// DDraw7
was created successfully. We must be at least DX7.0<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>dwDXVersion = 0x700;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>pDD7-&gt;lpVtbl-&gt;Release(pDD7);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
DirectX 8.0 Checks<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// Simply
see if D3D8.dll exists.<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>hD3D8DLL
= LoadLibrary( &quot;D3D8.DLL&quot; );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>if( hD3D8DLL
== NULL )<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style='mso-tab-count:1'>       </span><span
style="mso-spacerun: yes">    </span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">       
</span>return dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>//
D3D8.dll exists. We must be at least DX8.0<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>dwDXVersion = 0x800;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// End of
checking for versions of DirectX <o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>//-------------------------------------------------------------------------<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>// Close
open libraries and return<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>FreeLibrary( hDDrawDLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">   
</span>FreeLibrary( hD3D8DLL );<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'><span style="mso-spacerun: yes">    </span>return
dwDXVersion;<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-size:8.0pt;mso-bidi-font-size:12.0pt;
font-family:"Courier New"'>}<o:p></o:p></span></p>

<h3><a name="_Toc515331884"></a><a name="_Toc515374562"><span style='mso-bookmark:
_Toc515331884'>Checking the operating System version.</span></a></h3>

<p class=MsoNormal style='margin-bottom:6.0pt'>In addition to determining the
DirectX version, applications may also need to know what operating system they
are running on, and perhaps which Service Pack has been installed. The
preferred way to check the operating system version is to use the Windows API
function, <span style='font-family:"Courier New";mso-bidi-font-weight:bold'>GetVersionEx</span><b
style='mso-bidi-font-weight:normal'>.</b> This function returns an <span
style='font-family:"Courier New"'>OSVERSIONINFO</span> structure that contains
a variety of information including:<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=Lb1 style='line-height:12.0pt;mso-line-height-rule:exactly'><!--[if supportFields]><sup><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:Arial'><span
style='mso-element:field-begin'></span>SYMBOL 183 \f &quot;Symbol&quot; \s 11
\h </span></sup><![endif]--><!--[if supportFields]><sup><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:Arial'><span
style='mso-element:field-end'></span></span></sup><![endif]--><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:Arial'><span
style='mso-tab-count:1'>   </span>Whether the system is Microsoft Windows&nbsp;NT®-based
or Windows 95/98/ME<o:p></o:p></span></p>

<p class=Lb1 style='line-height:12.0pt;mso-line-height-rule:exactly'><!--[if supportFields]><sup><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:Arial'><span
style='mso-element:field-begin'></span>SYMBOL 183 \f &quot;Symbol&quot; \s 11
\h </span></sup><![endif]--><!--[if supportFields]><sup><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:Arial'><span
style='mso-element:field-end'></span></span></sup><![endif]--><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:Arial'><span
style='mso-tab-count:1'>   </span>The major and minor version numbers<o:p></o:p></span></p>

<p class=Lb1 style='line-height:12.0pt;mso-line-height-rule:exactly'><!--[if supportFields]><sup><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:Arial'><span
style='mso-element:field-begin'></span>SYMBOL 183 \f &quot;Symbol&quot; \s 11
\h </span></sup><![endif]--><!--[if supportFields]><sup><span style='font-size:
12.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:Arial'><span
style='mso-element:field-end'></span></span></sup><![endif]--><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;mso-bidi-font-family:Arial'><span
style='mso-tab-count:1'>   </span>The service pack number, for
Windows&nbsp;NT-based systems<o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The general procedure is to
determine the earliest version of the operating system that your application is
compliant with. If that version or later is installed, you can safely install
and run your application.<a style='mso-footnote-id:ftn4' href="#_ftn4"
name="_ftnref4" title=""><span class=MsoFootnoteReference><span
style='mso-special-character:footnote'><![if !supportFootnotes]>[4]<![endif]></span></span></a><span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>The following sample function
illustrates how to use <b style='mso-bidi-font-weight:normal'>GetVersionEx </b>to
test the operating system version. If the installed version is identical to or
more recent than the version specified in the parameter list, the function
returns TRUE. You can then safely install and execute your application.
Otherwise the function returns FALSE, indicating that your application will not
run properly, if <span style='font-size:10.0pt;mso-bidi-font-size:12.0pt'>at
all.</span><span style='font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:
Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'>#include
&lt;windows.h&gt;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'>#include
&lt;stdio.h&gt;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'>#include
&lt;tchar.h&gt;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'>BOOL
bIsWindowsVersionOK(<span style="mso-spacerun: yes">   </span>DWORD
dwWin9xMajor, DWORD dwWin9xMinor,<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                            </span>DWORD
dwWinNTMajor, DWORD dwWinNTMinor, WORD wWinNTSPMajor )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'>{<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>OSVERSIONINFO<span style="mso-spacerun:
yes">           </span>osvi;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>// Initialize the OSVERSIONINFO structure.<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>memset( &amp;osvi, sizeof( osvi ) );<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>osvi.dwOSVersionInfoSize = sizeof( osvi );<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span><o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>GetVersionEx( &amp;osvi );<span
style="mso-spacerun: yes">  </span>// Assume this function succeeds.<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>// Split code paths for NT and Win9x<span
style="mso-spacerun: yes">    </span><o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>if( osvi.dwPlatformId ==
VER_PLATFORM_WIN32_WINDOWS )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span>// Check the major version.<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span>if( osvi.dwMajorVersion &gt;
dwWin9xMajor )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">            </span>return TRUE;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span>else if( osvi.dwMajorVersion ==
dwWin9xMajor )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span>{<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">            </span>// Check the minor version.<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">            </span>if( osvi.dwMinorVersion &gt;=
dwWin9xMinor )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                </span>return TRUE;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span>}<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>else if( osvi.dwPlatformId ==
VER_PLATFORM_WIN32_NT )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>{<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes"> </span><span style="mso-spacerun: yes">      
</span>// Check the major version.<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span>if( osvi.dwMajorVersion &gt;
dwWinNTMajor )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">            </span>return TRUE;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span>else if( osvi.dwMajorVersion ==
dwWinNTMajor )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span>{<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">            </span>// Check the minor version.<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">            </span>if( osvi.dwMinorVersion &gt; dwWinNTMinor
)<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                </span>return TRUE;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">            </span>else if( osvi.dwMinorVersion ==
dwWinNTMinor )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">            </span>{<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                </span>// Check the service pack.<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                </span>DWORD dwServicePack = 0;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                </span>if( osvi.szCSDVersion )<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                </span>{<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                    </span>_stscanf(<span
style="mso-spacerun: yes">   </span>osvi.szCSDVersion,<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                                </span></span><span
lang=FR style='font-size:10.0pt;font-family:"Courier New";mso-ansi-language:
FR'>_T(&quot;Service Pack %d&quot;),<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span lang=FR style='font-size:10.0pt;font-family:"Courier New";
mso-ansi-language:FR'><span style="mso-spacerun:
yes">                                </span></span><span style='font-size:10.0pt;
font-family:"Courier New"'>&amp;dwServicePack );<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                </span>}<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">                </span>return ( dwServicePack &gt;=
wWinNTSPMajor );<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">            </span>}<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">        </span>}<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>}<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><span
style="mso-spacerun: yes">    </span>return FALSE;<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'>}<o:p></o:p></span></p>

<p class=Ex style='margin-left:3.9pt;line-height:12.0pt;mso-line-height-rule:
exactly'><span style='font-size:10.0pt;font-family:"Courier New"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><a name="_Toc515331885"></a><a name="_Toc515374563"><span style='mso-bookmark:
_Toc515331885'>Preparing for Compilation</span></a></h3>

<p class=MsoNormal style='margin-bottom:6.0pt'><span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h4 style='line-height:14.0pt;mso-line-height-rule:exactly'>Project link
libraries</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>If you are using the provided
sample project files, you do not need to verify these settings. They are
specified with the project files. For new applications, on the <b
style='mso-bidi-font-weight:normal'>Project</b> menu, click <b
style='mso-bidi-font-weight:normal'>Configuration</b>. </p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You should verify that the
application is linked to the appropriate standard DirectX link libraries.<span
style="mso-spacerun: yes">  </span>They are: ddraw.lib, dxguid.lib, and
ole32.lib at the bare minimum.<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<h4 style='line-height:14.0pt;mso-line-height-rule:exactly'>Debug vs. Retail
DLLs</h4>

<p class=MsoNormal style='margin-bottom:6.0pt'>The Microsoft DirectX SDK
installation program provides the option of installing either debug or retail
builds of the DirectX dynamic-link libraries (DLLs). <span style='font-family:
Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>When you develop software in C,
it is best to install the debug versions of the DLLs. This option installs both
debug and retail DLLs on your system. The retail option installs only the
retail DLLs. The debug DLLs have additional code that validates internal data
structures and output debug error messages, using the Microsoft Win32 API <span
style='font-family:"Courier New";mso-bidi-font-weight:bold'>OutputDebugString</span>
function, while your program is executing.<span style="mso-spacerun: yes"> 
</span>The strings that are passed to that primitive are shown by the lcc-win32
debugger in the events window, or in a message box. When an error occurs, the
debug output gives you a more detailed description of the problem. The debug
DLLs execute more slowly than the retail DLLs but are much more useful for
debugging an application. Be sure to ship the retail version with your
application. <span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal style='margin-bottom:6.0pt'>You can use the DirectX Control
Panel utility to switch between the debug and retail builds of DirectInput,
Direct3D, and DirectMusic. To enable this feature, select the debug option when
you install the SDK.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<span style='font-size:12.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-US;mso-fareast-language:EN-US;
mso-bidi-language:AR-SA'><br clear=all style='mso-special-character:line-break;
page-break-before:always'>
</span>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3>DXGetErrorMsg</h3>

<p class=MsoNormal>Returns the name associated with a DirectX error code.<span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoToc1><span style='font-family:"Courier New"'>TCHAR*
DXGetErrorString8(<span style="mso-spacerun: yes">  </span>HRESULT hr);<o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>Parameters<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><i>hr</i><i><span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></i></p>

<p class=MsoNormal>HRESULT value returned from a DirectX method. This handles
only error codes.<span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h5>Return Values</h5>

<p class=MsoNormal>If successful, this function returns a pointer to a string
that contains the name of the error code. If Unicode is set, DXGetErrorString8
will return a Unicode string. Otherwise, it will return an ANSI string. <span
style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal>Remarks<span style='font-family:Arial;mso-bidi-font-family:
"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal>This function is designed to retrieve the text equivalent of
a DirectX error message from a Direct3D, D3DX, DirectPlay, DirectInput,
DirectMusic, or DirectSound method. For example, if you set hr to 0x88768686,
DXGetErrorString8 will return D3DERR_DEVICELOST.<span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoNormal><span style='font-family:Arial;mso-bidi-font-family:"Times New Roman"'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<p class=MsoNormal>If an error code maps to more than one text string,
DXGetErrorMsg will return a generic string. For example, there are several
DirectX error codes, such as DIERR_OUTOFMEMORY, that indicate that you are out
of memory, and all map to the same value. If you set hr to any of these codes,
DXGetErrorString8 will return E_OUTOFMEMORY.<span style='font-family:Arial;
mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<h1 style='line-height:22.0pt;mso-line-height-rule:exactly'><span
style='font-size:12.0pt;mso-bidi-font-size:10.0pt;font-family:Arial;font-weight:
normal;mso-bidi-font-weight:bold'>To use this, function you need to link with
dxerr.lib.<o:p></o:p></span></h1>

</div>

<div style='mso-element:footnote-list'><![if !supportFootnotes]><br clear=all>

<hr align=left size=1 width="33%">

<![endif]>

<div style='mso-element:footnote' id=ftn1>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn1' href="#_ftnref1"
name="_ftn1" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[1]<![endif]></span></span></a> If an object
exposes an interface, it must support every method in the interface definition,
i.e. the table of function pointer must be filled with valid pointers. In other
words, you can call any method and be confident that it exists. However, the
details of how a particular method is implemented may vary from object to
object. For example, different objects may use different algorithms to arrive
at the final result. There is also no guarantee that a method will be supported
in a non-trivial way. Sometimes an object exposes a commonly used interface,
but needs to support only a subset of the methods. You will still be able to
call the remaining methods successfully, but they will return E_NOTIMPL.<span
style="mso-spacerun: yes">  </span>You should refer to the documentation to see
how any particular object implements an interface.</p>

</div>

<div style='mso-element:footnote' id=ftn2>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn2' href="#_ftnref2"
name="_ftn2" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[2]<![endif]></span></span></a> The list of
HRESULT values that you find on a method's reference page is often only a
subset of the possible values that may be returned. The list typically covers
only those values that are specific to the method and those standard values
that have some method-specific meaning. You should assume that a method may
return a variety of standard HRESULT values, even if they are not explicitly
documented.</p>

</div>

<div style='mso-element:footnote' id=ftn3>

<p class=MsoNormal><a style='mso-footnote-id:ftn3' href="#_ftnref3" name="_ftn3"
title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[3]<![endif]></span></span></a> <span
style='font-size:10.0pt'>Properly handling reference counting is a crucial part
of COM programming. Failure to do so can easily create a memory leak. One of
the most common mistakes that COM programmers make is failing to release an
interface. When this happens, the reference count will never reach zero, and
the object will remain in memory indefinitely. </span><span style='font-size:
10.0pt;font-family:Arial;mso-bidi-font-family:"Times New Roman"'><o:p></o:p></span></p>

<p class=MsoFootnoteText><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

<div style='mso-element:footnote' id=ftn4>

<p class=MsoFootnoteText><a style='mso-footnote-id:ftn4' href="#_ftnref4"
name="_ftn4" title=""><span class=MsoFootnoteReference><span style='mso-special-character:
footnote'><![if !supportFootnotes]>[4]<![endif]></span></span></a> The
operating system information returned by GetVersionEx should not be used to
test for the presence or version number of DirectX. In particular, the fact
that a system is Windows NT-based does not necessarily mean that DirectX is
absent. The Windows 2000 operating system, for example, includes DirectX 7.0 or
later. Future versions of Windows NT-based operating systems can also be
expected to include a version of DirectX. Use the procedures described in the
previous section to determine whether DirectX is present and, if so, the
version number.</p>

</div>

</div>

</body>

</html>
